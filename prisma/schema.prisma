// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  name     String? @db.VarChar(255)
  email    String  @unique @db.VarChar(255)
  password String?
  gender   String?
  category String?
  grade    String?
  availability String?
  courses studentCourse[]
  profilePicture String?
  articleComments articleComment[]
  certificates certificate[]
  cart cart?
  wishlist wishlist?
  orders orderInvoice[]
  transactions transaction[]
  createdAt DateTime @default(now())

}

model SuperAdmin {
  id       Int     @id @default(autoincrement())
  name     String? @db.VarChar(255)
  email    String?  @unique @db.VarChar(255)
  password String?
  availability String?
  createdAt DateTime @default(now())
}

model admin{
  id       Int      @id @default(autoincrement())
  name     String?   @db.VarChar(255)
  email    String?   @unique @db.VarChar(255)
  password String?
  availability String?
  createdAt DateTime @default(now())
}

model tutor{
  id       Int      @id @default(autoincrement())
  name     String?   @db.VarChar(255)
  email    String?   @unique @db.VarChar(255)
  password String?
  idNumber String
  address  String     @db.VarChar(500)
  forDisabled Boolean @default(false)
  profilePicture String
  about String?        @db.VarChar(5000)
  speciality String?
  experience String?
  education String?
  rating Int?
  fbUrl String?
  linkedInUrl String?
  twitterUrl String?
  instagramUrl String?
  availability String?
  courses course[]
  articles article[]
  verified Boolean @default(false)
  createdAt DateTime @default(now())
}

model course{
  id       Int      @id @default(autoincrement())
  name     String?   @db.VarChar(255)
  description String? @db.VarChar(50000)
  price Int?
  tutorId Int
  tutor tutor @relation(fields: [tutorId], references: [id])
  category categorisedCourse[]
  student studentCourse[]
  sections courseSections[]
  rating Int?
  image String?
  isPublished Boolean @default(false)
  verified Boolean @default(false)
  level String?
  requirements String?
  objectives String?
  certificate certificate?
  cartProducts cartProducts[]
  wishlistProducts wishlistProducts[]
  orders orderedCourses[]
  createdAt DateTime @default(now())
}

model category{
  id       Int      @id @default(autoincrement())
  name     String   @unique @db.VarChar(255)
  course categorisedCourse[]
  type Int
}

model categorisedCourse{
  id       Int      @id @default(autoincrement())
  courseId Int
  categoryId Int
  course course @relation(fields: [courseId], references: [id])
  category category @relation(fields: [categoryId], references: [id])
}

model studentCourse{
  id       Int      @id @default(autoincrement())
  studentId Int
  courseId Int
  student User @relation(fields: [studentId], references: [id])
  course course @relation(fields: [courseId], references: [id])
  progress Int?
  completed Boolean @default(false)
  startedAt DateTime?
  completedAt DateTime?
}

model courseSections{
  id       Int      @id @default(autoincrement())
  name     String?   @db.VarChar(255)
  description String? @db.VarChar(5000)
  createdAt DateTime @default(now())
  courseId Int
  published Boolean @default(false)
  course course @relation(fields: [courseId], references: [id])
  lessons lesson[]
}

enum lessonType {
  VIDEO
  TEXT
  AUDIO
}

model lesson{
  id       Int      @id @default(autoincrement())
  name     String?   @db.VarChar(255)
  description String? @db.VarChar(5000)
  videoUrl String?
  courseSectionsId Int
  courseSections courseSections @relation(fields: [courseSectionsId], references: [id])
  createdAt DateTime @default(now())
  type String
  isPreview Boolean @default(false)
  duration String?
}

model discount{
  id       Int      @id @default(autoincrement())
  code     String   @unique @db.VarChar(255)
  name     String?   @db.VarChar(255)
  discount Decimal?
  expiryDate DateTime?
  purpose String?
}

model permissions{
  id       Int      @id @default(autoincrement())
  name     String   @unique @db.VarChar(255)
  role     String? @db.VarChar(255)
  permissionFor String? @db.VarChar(255)
  status Boolean @default(false)

}

model article{
  id       Int      @id @default(autoincrement())
  title    String?   @db.VarChar(255)
  content String? @db.VarChar()
  authorId Int
  author  tutor @relation(fields: [authorId], references: [id])
  publishedAt DateTime?
  verified Boolean @default(false)
  comments articleComment[]
}

model articleComment{
  id       Int      @id @default(autoincrement())
  articleId Int
  userId Int
  content String? @db.VarChar(5000)
  article article @relation(fields: [articleId], references: [id])
  user User @relation(fields: [userId], references: [id])
  createdAt DateTime?
}

model certificate{
  id       Int      @id @default(autoincrement())
  courseId Int  @unique
  studentId Int
  course course @relation(fields: [courseId], references: [id])
  student User @relation(fields: [studentId], references: [id])
  issuedAt DateTime?
  certificateUrl String?
  verified Boolean @default(false)
}

model cart{
  id       Int      @id @default(autoincrement())
  userId   Int      @unique
  user User @relation(fields: [userId], references: [id])
  cartProducts cartProducts[]
  createdAt DateTime @default(now())

}

model cartProducts{
  cartId Int
  courseId Int
  cart cart @relation(fields: [cartId], references: [id])
  course course @relation(fields: [courseId], references: [id])
  savedForLater Boolean @default(false)
  createdAt DateTime @default(now())

  @@id([cartId, courseId])
}

model wishlist{
  id       Int      @id @default(autoincrement())
  userId Int        @unique
  user User @relation(fields: [userId], references: [id])
  wishlistProducts wishlistProducts[]
  createdAt DateTime @default(now())
}

model wishlistProducts{
  wishlistId Int
  courseId Int
  wishlist wishlist @relation(fields: [wishlistId], references: [id])
  course course @relation(fields: [courseId], references: [id])
  createdAt DateTime @default(now())
  @@id([wishlistId, courseId])
}

model orderInvoice{
  id       Int      @id @default(autoincrement())
  orderName String 
  userId Int
  user User @relation(fields: [userId], references: [id])
  products orderedCourses[]
  totalAmount Decimal?
  paymentMethod String?
  paymentStatus String?
  transaction transaction @relation(fields: [id], references: [id])
  createdAt DateTime @default(now())
}

model orderedCourses{
  id       Int      @id @default(autoincrement())
  orderId Int
  courseId Int
  orderInvoice orderInvoice @relation(fields: [orderId], references: [id])
  course course @relation(fields: [courseId], references: [id])
  createdAt DateTime @default(now())
}

model transaction{
  id       Int      @id @default(autoincrement())
  userId Int
  user User @relation(fields: [userId], references: [id])
  amount Decimal?
  transactionId String
  paymentStatus String
  orderInvoice orderInvoice?
  transactionType String?
  transactionStatus String?
  createdAt DateTime @default(now())
}